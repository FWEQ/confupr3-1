# confupr3-1 Клочков Федор Александрович ИКБО-71-24

---

# Ассемблер УВМ — Этап 1 (Вариант 11)

Этот проект содержит простую реализацию ассемблера на Python для учебной виртуальной машины. На первом этапе реализован разбор текстового файла с ассемблерными командами и вывод промежуточного представления (IR).

## Что реализовано

### 1. Чтение входного файла `.asm`

Реализована обработка текстового файла с ассемблерным кодом.
Расширение `.asm` используется как стандартное обозначение файлов с ассемблерными инструкциями.

### 2. Поддержка базовых команд варианта 11

Реализованы следующие команды:

* `ld_const N -> acc` — загрузка константы в аккумулятор
* `load [acc + N] -> acc` — загрузка значения из памяти
* `store acc -> [N]` — сохранение значения в память

Команды выбираются по словарю опкодов.

### 3. Простой парсер строк

Выполняется базовая обработка каждой строки:

* удаление комментариев,
* выделение мнемоники команды,
* извлечение первого числового операнда с помощью регулярного выражения,
* проверка корректности команды.

Такой формат соответствует требованиям этапа 1 и обеспечивает стабильную работу.

### 4. Формирование промежуточного представления (IR)

Каждая команда преобразуется в структуру с полями:

* `mnemonic` — название команды,
* `A` — числовой код операции,
* `B` — операнд,
* `size` — размер инструкции (7 байт),
* `bytes` — список байтов инструкции.

Байты формируются по схеме:

* байт 0: opcode A,
* байт 1: младший байт B,
* байт 2: старший байт B,
* байты 3–6: нули.

### 5. Режим тестирования

Запуск с флагом `--test` выводит IR в формате JSON и завершает работу без создания бинарного файла.

Пример запуска:

```
python3 assembler.py --src program.asm --out output.bin --test
```

### 6. Генерация бинарного файла

При обычном запуске без `--test` программа создаёт бинарный файл, в котором инструкции записаны последовательно, по 7 байт каждая.

Пример запуска:

```
python3 assembler.py --src program.asm --out output.bin
```

## Структура проекта

* `assembler.py` — основной скрипт ассемблера
* `program.asm` — пример входного файла (ассемблерный код)
* `output.bin` — результирующий бинарный файл (генерируется программой)

---